<!DOCTYPE html>
<html lang="en">
  <head>
    <title>codevember </title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/feiss/aframe-environment-component/ad57b15d/dist/aframe-environment-component.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v2.1.0/dist/aframe-physics-system.min.js"></script>
  </head>
  <body>
    <a-scene physics>
      <a-assets>      
        <a-asset-item id="gun-obj" src="https://cdn.glitch.com/1d750fac-a652-409d-949b-156f935085a2%2Fgun-1NI7Q2_vScX-model.obj?1510641419352"></a-asset-item>
        <a-asset-item id="gun-mtl" src="https://cdn.glitch.com/1d750fac-a652-409d-949b-156f935085a2%2Fgun-1NI7Q2_vScX-materials.mtl?1510641419027"></a-asset-item>
       
        <a-asset-item id="trophy1-obj" src="models/trophy1/Cup.obj"></a-asset-item>
        <!-- <a-asset-item id="trophy1-mtl" src="models/trophy1/Cup.mtl"></a-asset-item>    -->
        <a-asset-item id="trophy2-obj" src="models/trophy2/Pokal.obj"></a-asset-item>
        <a-asset-item id="ghost-obj" src="models/ghost/3d-model.obj"></a-asset-item>
            
          
        <audio id="sfx-gun" src="https://cdn.glitch.com/1d750fac-a652-409d-949b-156f935085a2%2Ftrimmed-40MM%20M79%20grenade%20launcher%20single%20shot%20close%20perspective_BLASTWAVEFX_09562.mp3?1510643217955" crossorigin="anonymous" ></audio>
        <audio id="sfx-copabr" src="sound/copabr.ogg" crossorigin="anonymous" preload="true" ></audio>
        <audio id="sfx-rosca" src="sound/rosca.ogg" crossorigin="anonymous" preload="true" ></audio>
        <audio id="sfx-falazeze" src="sound/falazeze.mpeg" crossorigin="anonymous" preload="true" ></audio>
        
          
          <img id="orangesrc" src="https://cdn.glitch.com/1d750fac-a652-409d-949b-156f935085a2%2Ff7d31bc38804a89a6b288f718296cc27.jpg?1510638410703" crossorigin="anonymous" /> 
        <img id="orangebump" src="https://cdn.glitch.com/1d750fac-a652-409d-949b-156f935085a2%2Forangebump1.jpg?1510639083481" crossorigin="anonymous" /> 
          
          
          <img id="throwsrc" src="https://cdn.glitch.com/1d750fac-a652-409d-949b-156f935085a2%2Ff7d31bc38804a89a6b288f718296cc27.jpg?1510638410703" crossorigin="anonymous" /> 
          
          <img id="timegrandesrc" src="img/timegrande.jpg" crossorigin="anonymous" /> 
          <img id="brasileirao" src="img/brasileirao.png" crossorigin="anonymous" /> 
          <img id="copabr" src="img/copabr.jpg" crossorigin="anonymous" /> 
          <img id="six" src="img/six.png" crossorigin="anonymous" /> 
          <img id="fabio" src="img/fabio.png" crossorigin="anonymous" /> 
          <img id="b" src="img/b.png" crossorigin="anonymous" /> 
          <img id="cerca" src="img/cerca.png" crossorigin="anonymous" /> 
          
          
          <img id="aecio" src="img/people/aecio.png" crossorigin="anonymous" />
          <img id="alberto" src="img/people/alberto.png" crossorigin="anonymous" />
          <img id="ceni" src="img/people/ceni.png" crossorigin="anonymous" />
          <img id="choro" src="img/people/choro.png" crossorigin="anonymous" />
          <img id="fe" src="img/people/fe.png" crossorigin="anonymous" />
          <img id="bola" src="img/people/bola.png" crossorigin="anonymous" />
          <img id="gordo" src="img/people/gordo.png" crossorigin="anonymous" />
          <img id="itair" src="img/people/itair.png" crossorigin="anonymous" />
          <img id="perrella" src="img/people/perrella.png" crossorigin="anonymous" />
          <img id="serginho" src="img/people/serginho.png" crossorigin="anonymous" />
          <img id="tiago" src="img/people/tiago.png" crossorigin="anonymous" />
          <img id="wagner" src="img/people/wagner.png" crossorigin="anonymous" />
          
          <a-mixin id="text" text="align: center; value: anos na serie B"></a-mixin>
         <a-mixin id="tutorial" text="align: center; value: #borareconstruir ajude o cabuloso! Afaste a serie B usando toda a tradicao azul!"></a-mixin>
         
      </a-assets>
        
    
      <a-entity id="cam" camera="userHeight: 1.6" look-controls wasd-controls position="0 0 10">
        
            <a-entity cursor
                  position="0 0 -0.5"
                   
                  geometry="primitive: circle; radius: 0.01; segments: 4;"
                  material="color: #FF4444; shader: flat"></a-entity>
      </a-entity>
        
      <a-entity id="env1" environment="preset:forest; shadow:true; seed:19; lightPosition: 0.7 0.7 0.7"></a-entity>
      
        
        <a-text mixin="tutorial" id="tutorial" rotation="0 20 0" font="kelsonsans" position="0 2 5" width="8" wrap-count="20"></a-text> 
        
        
     <a-entity id="texto" position="8.5 5 -2.5"  text="value: Hello World;"></a-entity>
        <a-sphere  
                obj-model="obj: #ghost-obj;" 
                  id="ghost"
                  rotation="0 310 0"
                 position="8.5 60 -2.5"  dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
     <a-box id="terrainscore"  width="2" height="0.1" depth="2" position="8.5 5 -2.5" static-body visible="false"></a-box>
        
        <a-text mixin="text"  rotation="0 310 0" font="kelsonsans" position="8.9 4.65 -0.94" width="8" wrap-count="10"></a-text> 
        <a-text id="score" rotation="0 310 0" text="value: 1;" font="kelsonsans" position="9.8 7.34 -1" width="60"></a-text> 
        
        <a-entity id="throw0"
                  class="throw"
                  dynamic-body 
                  velocity="0 0 20" 
                  sound="src: #sfx-copabr; autoplay: false;" 
                  obj-model="obj: #trophy1-obj;" 
                  position="0 5 20" 
                  shadow rotation="0 90 0"
                  scale="0.3 0.5 0.3"
                  material="src: #copabr; repeat: 50 10"></a-entity>   
        <a-entity id="throw1" 
                  class="throw"
                  dynamic-body 
                  velocity="0 0 20" 
                  sound="src: #sfx-rosca; autoplay: false;" 
                  obj-model="obj: #trophy2-obj;" 
                  position="0 5 20" 
                  shadow rotation="0 90 0"
                  material="src: #brasileirao; repeat: 5 5"></a-entity>           
        <a-entity id="throw2" 
                  class="throw"
                  dynamic-body 
                  position="0 5 20" 
                  velocity="0 0 20"
                  sound="src: #sfx-faazeze; autoplay: false;"
                  geometry="primitive: box; radius: 0.5" 
                  material="src: #timegrandesrc; repeat: 1 1" 
                  shadow="cast:true;receive:true"></a-entity>
        <a-entity id="throw3" 
                  class="throw"
                  dynamic-body 
                  position="0 5 20" 
                  velocity="0 0 20" 
                  sound="src: #sfx-rosca; autoplay: false;"
                  geometry="primitive: box; radius: 0.5" 
                  material="src: #six; repeat: 1 1" 
                  shadow="cast:true;receive:true"></a-entity>
        <a-entity id="throw4" 
                  class="throw"
                  dynamic-body 
                  position="0 5 20" 
                  velocity="0 0 20" 
                  sound="src: #sfx-copabr; autoplay: false;"
                  geometry="primitive: box; radius: 0.5" 
                  material="src: #fabio; repeat: 1 1" 
                  shadow="cast:true;receive:true"></a-entity>        
        
    
        
     
        <!-- Physics terrain -->
        <a-box id="terrain" width="75" height="0.1" depth="150" position="0 0 0" static-body visible="false"></a-box>
        <!-- parede -->    
        <a-box id="wall" width="20" height="2" depth="1" position="1 1.5 11.5" material="color: red; opacity: 0.5" static-body></a-box>
        
        <a-box width="20" 
               material="src: #cerca; repeat: 10 1; opacity: 0.9"
               height="1" depth="0.2" position="-7.5 0.6 2" rotation="0 270 0" static-body></a-box>
        <a-box width="20"
               material="src: #cerca; repeat: 10 1; opacity: 0.9"
               height="1" depth="0.2" position="7.5 0.6 2" rotation="0 270 0" static-body></a-box>

        
        
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="8.5 1 8.2" 
               material="src: #itair; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="8.5 1.2 5" 
               material="src: #fe; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>        
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="8.5 2 1" 
               material="src: #serginho; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>
     
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="8.5 2 -2.5" 
               material="src: #ceni; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="8.5 1 -5.8" 
               material="src: #alberto; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>        
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="8.5 1 -9" 
               material="src: #aecio; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>        
    
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="-8.5 0.7 8.2" 
               material="src: #wagner; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="-8.5 0.7 5" 
               material="src: #bola; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>        
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="-8.5 0.7 1" 
               material="src: #perrella; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>
     
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="-8.5 0.7 -2.5" 
               material="src: #tiago; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="-8.5 0.7 -5.8" 
               material="src: #choro; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>        
        <a-box class="people" height="3" depth="3" width="0.1" 
               position="-8.5 0.7 -9" 
               material="src: #gordo; repeat: 1 1; transparent:true"
               dynamic-body force-pushable shadow></a-box>  
        
        <!-- Blocks row 1 -->
      
  <a-sphere class="enemy" position="-5 0.5 -20" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
      <a-sphere class="enemy" position="0 0.5 -8" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
      <a-sphere class="enemy" position="5 0.5 -12" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
      <a-sphere class="enemy" position="3 0.5 -20" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
  
        <a-sphere class="enemy" position="5 0.5 -25" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
      <a-sphere class="enemy" position="0 0.5 -30" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
      <a-sphere class="enemy" position="-5 0.5 -33" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
    <!--
        <a-sphere class="enemy" position="-3 0.5 -38" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-sphere>
      <a-box class="enemy" position="5 0.5 0" dynamic-body force-pushable shadow material="src: #b; repeat: 1 1"></a-box>
      -->

    </a-scene>
  </body>
  <script>
    
    setTimeout(function(){
        window.addEventListener('mouseup', function () {
            var itenN = Math.floor(Math.random() * 5);
            dothrow("#throw" + itenN);
            jumpPeople(3);
        });
        
        document.getElementById("tutorial").setAttribute("visible",false);
        
        setInterval(function(){
            var enemies = document.getElementsByClassName("throw");
            for (var i = 0; i < enemies.length; i++) {
                enemies.item(i).body.velocity.set(0, 0, 2);;
            }    
        },1000) 
    }, 600)
      
      
      
 
      
      
    function DegreesToRadians(valDeg){
        return ((2*Math.PI)/360*valDeg)
    }
      
      
    function jumpPeople(qtd){
        var people = document.getElementsByClassName("people");
        for (var i = 0; i < qtd; i++) {
           people.item(Math.floor(Math.random() * people.length)).body.velocity.set(0, 1, 0);;
        }
    }  
    function dothrow(item){
        console.log("dotwrow: " + item)
        
        var x = document.getElementById("cam").getAttribute("position").x;  
        var y = document.getElementById("cam").getAttribute("position").y;
        var z = document.getElementById("cam").getAttribute("position").z;
        document.querySelector(item).body.position.set(x, y, z);

         
        var angle = (document.getElementById("cam").getAttribute("rotation").y);
        var up = (document.getElementById("cam").getAttribute("rotation").x);
        
        var hip = 20;
        var velocityX = 10;
        var velocityY = 10;
        
        velocityX = hip * Math.sin(DegreesToRadians(angle))
		velocityY = hip * Math.cos(DegreesToRadians(angle))
        
        
        
        document.querySelector(item).body.velocity.set(-velocityX, up, -velocityY);
        console.log(document.querySelector(item).body.velocity)
        
        
        var throwitens = document.getElementsByClassName("throw");
        for (var i = 0; i < throwitens.length; i++) {
            throwitens.item(i).components.sound.stopSound();
        } 

        document.querySelector(item).components.sound.playSound();
    }  
      
      
      
    var playerEl = document.getElementById("wall")
    var score = 1;
    playerEl.addEventListener('collide', function (e) {
      console.log('Player has collided with body #' + e.detail.body.id);
        
        if(e.detail.body.el.className.indexOf("enemy") >=0){
            score = score + 1;
            document.getElementById("score").setAttribute("text", "value: "+score+";");
            e.detail.body.el.body.position.set(Math.floor(Math.random() * 10)-5, 0, -10);
            document.getElementById("ghost").body.velocity.set(0, 5, 0);       
        }
        
        
        console.log(e.detail.body.el)
      e.detail.target.el;  // Original entity (playerEl).
      e.detail.body.el;    // Other entity, which playerEl touched.
      e.detail.contact;    // Stats about the collision (CANNON.ContactEquation).
      e.detail.contact.ni; // Normal (direction) of the collision (CANNON.Vec3).
    });  
  </script>
</html>